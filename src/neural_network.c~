/*
** EPITECH PROJECT, 2018
** simple value iteration algorithm
** File description:
** Implementation of neural network with Fann library
*/

#include "value_iteration.h"
#include "neural_network.h"

void test_learning(const float values[MAP_SIZE][MAP_SIZE])
{
	struct fann *ann = fann_create_standard(3, 2, 5, 1);
	float entries[2];

	if (!ann)
		return;
	fann_randomize_weights(ann, -0.5f, 0.5f);
	fann_set_activation_function_hidden(ann, FANN_SIGMOID_SYMMETRIC);
	fann_set_activation_function_output(ann, FANN_LINEAR);

	for (int y = 0; y < MAP_SIZE; y++)
		for (int x = 0; x < MAP_SIZE; x++) {
			entries[0] = x;
			entries[1] = y;
			fann_train(ann, entries, &values[y][x]);
		}

	for (int y = 0; y < MAP_SIZE; y++)
		for (int x = 0; x < MAP_SIZE; x++) {
			entries[0] = x;
			entries[1] = MAP_SIZE - 1 - y;
			printf("%7.4f ", fann_run(ann, entries);
		}
				
}
